# D2 Advance

D2 Advance æ˜¯å— [D2 Admin](https://github.com/d2-projects/d2-admin/) äº¤äº’è®¾è®¡å½±å“å¯å‘çš„æ–°é¡¹ç›®ã€‚ä¿ç•™ D2 Admin ç»å…¸è®¾è®¡çš„åŒæ—¶ï¼Œ**æ•´ç†å‡ºæ¸…æ™°çš„æ¶æ„ã€æå‡ä»£ç è´¨é‡å’Œè§„èŒƒå¼€å‘æµç¨‹**ï¼Œæ¢ç´¢ä¸­åå°åŠå…¶ä»¥å¤–çš„æ›´å¤šåº”ç”¨åœºæ™¯ã€‚

ä½¿ç”¨é¡»çŸ¥ï¼š

- å’Œ D2 Admin 1x ç‰ˆæœ¬çš„ä»£ç å®Œå…¨ä¸ä¸€æ ·ï¼Œ**ä½ éœ€è¦é‡æ–°å­¦ä¹ ï¼Œå…ˆçœ‹æ‡‚å†ç”¨**ï¼Œé¿å…é£é™©
- ä»£ç é‡Œæ²¡æœ‰æ³¨é‡Šï¼Œ**å¥½çš„ä»£ç ä¸éœ€è¦æ³¨é‡Š**ï¼Œå¦‚æœæœ‰ï¼Œè¦ä¹ˆæ˜¯æ ‡æ³¨çš„æ–‡æ¡£åœ°å€ï¼Œè¦ä¹ˆæ˜¯æœ‰å‘
- åŸºäº vue-cli@4ï¼Œè¯·ä¸€å®šè¦ç†Ÿæ‚‰ [vue-cli](https://cli.vuejs.org/) çš„æ–‡æ¡£ï¼Œå®ƒèƒ½è§£å†³ä½ é‡åˆ°çš„å¤§éƒ¨åˆ†é—®é¢˜
- æ›´è§„èŒƒçš„ä»£ç æäº¤ã€ç‰ˆæœ¬æ¼”è¿›å’Œè‡ªåŠ¨åŒ–å‘å¸ƒï¼Œ**éœ€è¦å¼€å‘è€…åšå¥½æ¯ä¸€æ¬¡æäº¤**
- **è¯·ä¸è¦å…³é—­ lint å’Œæµ‹è¯•ç­‰æç¤ºï¼Œè¿™æ˜¯ä»£ç è´¨é‡çš„åŸºæœ¬ä¿éšœ**ï¼Œå¦‚æœä¸èƒ½æ¥å—ï¼Œè¯·å‹¿ä½¿ç”¨è¯¥é¡¹ç›®

## ç¯å¢ƒè¦æ±‚

### NodeJS

NodeJS ç‰ˆæœ¬è¦æ±‚å— `devDependencies` å½±å“ï¼Œä»¥ä¸‹æ˜¯ä¸»è¦çš„ä¾èµ–æ¸…å•ã€‚å°½ç®¡æœ‰çš„ä¾èµ–çš„æ–°ç‰ˆæœ¬åœ¨è¯¥é¡¹ç›®è¿˜æœªé‡‡ç”¨ï¼Œä½†ä¸ºäº†ä¹‹åçš„å‡çº§ï¼Œè¿™é‡Œä»¥æ–°ç‰ˆæœ¬ä¸ºå‡†ã€‚

æ¨è `node@12`

-   æ‰“åŒ…ä½¿ç”¨çš„ [brotli](https://github.com/webpack-contrib/compression-webpack-plugin#using-brotli) å‹ç¼©ç®—æ³•éœ€è¦ `>= node@11.7.0`

æœ€ä½ `node@10`

-   `webpack@5` éœ€è¦ `>= node@10.13.0`
-   `prettier@2` éœ€è¦ `>= node@10`

**è¯¥é¡¹ç›®ä½¿ç”¨ yarn ä½œä¸ºåŒ…ç®¡ç†å™¨**ï¼Œå¦‚æœæ²¡æœ‰å…¨å±€å®‰è£…ï¼Œè¯·è¿è¡Œ `npm i -g yarn` å®‰è£…ã€‚

## å¿«é€Ÿå¼€å§‹

è¯¥é¡¹ç›®å¯ä»¥ç›´æ¥ä½œä¸ºé¡¹ç›®æ¨¡ç‰ˆï¼Œè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä»¥ä¸‹å‡ ç§æ¨èå‡ ç§åˆå§‹åŒ–æ–¹å¼ï¼Œä»»é€‰å…¶ä¸€ï¼š

-   é€‚åˆç§æœ‰é¡¹ç›®äºŒæ¬¡å¼€å‘ï¼šç‚¹å‡»ä»“åº“ä¸Šæ–¹å·¥å…·æ çš„ä¸‹è½½ zip æŒ‰é’®ï¼Œç›´æ¥ä¸‹åœ¨çº¯æºç ã€‚åœ¨æœ¬åœ°è§£å‹åï¼Œè‡ªè¡Œåˆå§‹åŒ–ä¸º git ä»“åº“æˆ–å…¶ä»–ç±»å‹çš„ä»“åº“ã€‚
-   é€‚åˆå¼€æºé¡¹ç›®äºŒæ¬¡å¼€å‘ï¼šä½¿ç”¨ github çš„æ¨¡ç‰ˆåˆå§‹åŒ–åŠŸèƒ½ï¼Œåˆ›å»ºä¸€ä¸ªåªå¸¦ä¸€æ¬¡æ–‡ä»¶åˆå§‹åŒ–æäº¤çš„ github ä»“åº“ï¼Œå¹¶ `git clone` åˆ°æœ¬åœ°ã€‚
-   é€‚åˆè¯¥é¡¹ç›®è´¡çŒ®è€…ï¼šç›´æ¥ `git clone` åˆ°æœ¬åœ°ã€‚

æœ¬åœ°é¡¹ç›®æ–‡ä»¶å¤¹å‡†å¤‡å®Œæ¯•åï¼Œå°†å‘½ä»¤è¡Œåˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œå¹¶æŒ‰ä»¥ä¸‹å‘½ä»¤æ“ä½œï¼š

``` bash
# å®‰è£…ä¾èµ–
yarn

# å¯åŠ¨å¼€å‘æœåŠ¡
yarn serve
```

å¯åŠ¨å®Œæˆåï¼Œæµè§ˆå™¨è®¿é—® [http://localhost:8080](http://localhost:8080) å³å¯é¢„è§ˆã€‚

## å¼€å‘è§„èŒƒ

### å°æ­¥æäº¤

åœ¨ä½¿ç”¨ git ç®¡ç†ä»£ç æ—¶ï¼Œæå€¡**å°æ­¥æäº¤**ï¼Œå³äº§ç”Ÿä¸€ä¸ªåŠŸèƒ½æœ€å°åŒ–ï¼Œä¸”èƒ½è¿è¡Œçš„ä»£ç ï¼Œå°± commit åˆ°æœ¬åœ°ã€‚åœ¨å‡ æ¬¡ commit å½¢æˆä¸€ä¸ªå°åŠŸèƒ½åï¼Œå°± push åˆ°è¿œç¨‹ä»“åº“ã€‚

``` bash
# ğŸ‘
git commit -m "feat: æ·»åŠ ç™»é™†é¡µé¢ï¼Œä¿®å¤è‹¥å¹²é—®é¢˜ï¼Œæ·»åŠ æ‰“åŒ…å‘½ä»¤"
git push

# ğŸ‘
git commit -m "feat: æ·»åŠ ç™»é™†é¡µé¢"
git commit -m "fix: ç™»é™†å¤±è´¥ç¼ºå°‘é”™è¯¯æç¤º"
git commit -m "chore(npm): æ·»åŠ é¢„è§ˆç‰ˆæœ¬çš„æ‰“åŒ…å‘½ä»¤"
git push
```

å¥½å¤„ï¼š
- åœ¨å¤šäººåä½œçš„æƒ…å†µä¸‹ï¼Œèƒ½åŠæ—¶åŒæ­¥ä»£ç ï¼Œäº§ç”Ÿå†²çªèƒ½æå‰å‘ç°
- æé«˜å¯¹ä»£ç çš„å½’çº³æ€»ç»“èƒ½åŠ›ï¼Œç±»ä¼¼äºè¯­æ–‡ä¸­çš„åˆ’åˆ†æ®µè½ï¼Œå¹¶å½’çº³ä¸­å¿ƒæ€æƒ³ :)

### é¢„å®šå¼æäº¤

åœ¨å°æ­¥æäº¤çš„æå‡ºä¸Šï¼Œè¿›ä¸€æ­¥ä¹¦å†™**æ ¼å¼ç»Ÿä¸€ã€æè¿°å‡†ç¡®**çš„ commit messageï¼Œè€Œä¸æ˜¯éšæ„ä¹¦å†™ï¼š

``` bash
# ğŸ‘
git commit -m "ç™»é™†"
git commit -m "ç™»é™†å¤±è´¥æ˜¾ç¤ºé”™è¯¯æç¤º"
git commit -m "æ‰“åŒ…"

# ğŸ‘
git commit -m "feat: æ·»åŠ ç™»é™†é¡µé¢"
git commit -m "fix: ç™»é™†å¤±è´¥ç¼ºå°‘é”™è¯¯æç¤º"
git commit -m "chore(npm): æ·»åŠ é¢„è§ˆç‰ˆæœ¬çš„æ‰“åŒ…å‘½ä»¤"
```

å¥½å¤„ï¼š
- ç»Ÿä¸€æ ¼å¼ï¼Œæ–¹ä¾¿æŸ¥é˜…
- ä¾¿äºè‡ªåŠ¨ç”Ÿäº§å˜æ›´æ—¥å¿—å’Œç‰ˆæœ¬å·

è¯¥é¡¹ç›®é‡‡ç”¨å¸¸è§çš„ [angular æäº¤å‡†åˆ™](https://github.com/angular/angular.js/blob/master/CONTRIBUTING.md#commit)ï¼Œå…·ä½“å¯å‚è€ƒï¼šhttps://www.conventionalcommits.org/zh-hans

ä¸ºé¿å…æ‰‹å†™å¤±è¯¯ï¼Œè¯¥é¡¹ç›®å·²ç»ä½¿ç”¨ [commitizen](https://github.com/commitizen/cz-cli) å·¥å…·è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯ä»¥ç›´æ¥åœ¨å‘½ä»¤è¡Œä¸­ä½“éªŒäº¤äº’å¼æäº¤ï¼Œé€šè¿‡é€‰æ‹©+å¡«ç©ºçš„æ–¹å¼ç”Ÿæˆè§„èŒƒçš„ commit messageï¼š

``` bash
# æ–¹æ³• 1
# è¦å…ˆè¿è¡Œ `npm i -g commitizen` å…¨å±€å®‰è£… commitizen
git cz

# æ–¹æ³• 2
yarn commit # æˆ– npm run commit
```

### åˆ†æ”¯ç®¡ç†

**ç§æœ‰é¡¹ç›®å’Œå¼€æºé¡¹ç›®çš„ä¾§é‡ç‚¹ä¸åŒï¼Œåœ¨åˆ†æ”¯ç®¡ç†ä¸Šä¼šæœ‰åŒºåˆ«ã€‚**

#### å¼€æºé¡¹ç›®

è¯¥ä»“åº“ä½¿ç”¨çš„ç®€å•çš„ master + dev æ¨¡å¼ï¼š

-   `master`ï¼šé»˜è®¤åˆ†æ”¯ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„ç‰ˆæœ¬ tagï¼Œæœ€åä¸€æ¬¡æäº¤æ°¸è¿œæ˜¯æœ€è¿‘ä¸€æ¬¡ç‰ˆæœ¬å‘å¸ƒï¼Œä¿è¯åŒä¸ªç‰ˆæœ¬ä¸‹è½½çš„ä»£ç éƒ½æ˜¯ä¸€è‡´çš„ï¼ŒåŒæ—¶ä¹Ÿå’Œéƒ¨ç½²åˆ°é¢„è§ˆçš„ä»£ç ä¸€è‡´
-   `dev`ï¼šå¼€å‘åˆ†æ”¯ï¼Œé‡Œé¢æ˜¯ä¸Šä¸€æ¬¡ç‰ˆæœ¬å‘å¸ƒåï¼Œå¾…å‘å¸ƒçš„æäº¤ï¼Œå½“éœ€è¦å‘å¸ƒæ—¶ç›´æ¥åˆå¹¶åˆ° `master`
-   `gh-pages`ï¼šéƒ¨ç½² Github Pages æ—¶ç”Ÿäº§çš„åˆ†æ”¯ï¼Œè¯·å¿½ç•¥

å¼€å‘æµç¨‹å¦‚ä¸‹ï¼š

``` bash
# ...åœ¨ dev å®Œæˆå¤šæ¬¡ commit å
(dev) git push
(dev) git checkout master
(master) git merge dev # æŠŠå³å°†å‘å¸ƒçš„ä»£ç åˆå¹¶åˆ° master
(master) git push
# ...ç­‰å¾…å‘å¸ƒå®Œæˆ
(master) git pull # å‘å¸ƒçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè‡ªåŠ¨äº§ç”Ÿä¸€äº›æäº¤
(master) git checkout dev
(dev) git merge master
(dev) git push # è®© dev ä¸ master ä¿æŒä¸€è‡´
# ... ç»§ç»­åœ¨ dev å¼€å‘
```

#### ç§æœ‰é¡¹ç›®

ç§æœ‰é¡¹ç›®ä¸€èˆ¬ä¼šæœ‰å¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­æ›´å¤šå…³æ³¨å¼€å‘ç¯å¢ƒä¸æœ€æ–°ä»£ç ï¼Œæ‰€ä»¥å¤šä¸º master + release çš„æ–¹å¼ã€‚
å¦‚æœä½ æ˜¯ä»¥è¯¥é¡¹ç›®ä¸ºæ¨¡ç‰ˆçš„ç§æœ‰é¡¹ç›®ï¼Œç›´æ¥åœ¨ master å¼€å‘ï¼Œåœ¨å¿…è¦çš„æ—¶å€™åˆ‡ release åˆ†æ”¯å³å¯ã€‚

### ä»£ç é£æ ¼

``` bash
# æ£€æŸ¥ä»£ç é£æ ¼ï¼Œå¹¶è‡ªåŠ¨ä¿®å¤
yarn lint

# ä¸¥æ ¼æ£€æŸ¥ï¼Œä¸ä¼šè‡ªåŠ¨ä¿®å¤
yarn lint:strict
```

#### é…ç½®

ä»£ç é£æ ¼è®¾ç½®ä¸»è¦ä»¥ eslint ä¸ºä¸»ï¼Œæ­é… [prettier](https://prettier.io/docs/en/options.html) å’Œ [vue](https://github.com/vuejs/eslint-plugin-vue/blob/master/docs/rules/README.md) çš„ lint è§„åˆ™ï¼š

``` js
// .eslintrc

module.exports = {
  // ...
  extends: [
    'eslint:recommended',
    'plugin:vue/recommended',
    '@vue/prettier'
  ],
  // ...
}
```

å¯ä»¥å°† `'plugin:vue/recommended'` æ¢æˆ `'plugin:vue/essential'` ä»¥ä½¿ç”¨æ›´ç®€å•çš„ vue è§„åˆ™ã€‚

å¦‚ä½•è¦†ç›– prettier çš„è§„åˆ™ï¼š

``` js
// .eslintrc

module.exports = {
  // ...
  rules: {
    'prettier/prettier': [
      'warn',
      {
        singleQuote: true,
        semi: false,
        trailingComma: 'none',
        quoteProps: 'preserve',
        arrowParens: 'always'
      }
    ]
  },
  // ...
}
```

## æ–‡ä»¶ç»“æ„

TODO

## ä»£ç æ¶æ„

TODO

## æµ‹è¯•

TODO

## æ‰“åŒ…

TODO

## éƒ¨ç½²

TODO

## CI/CD

TODO
